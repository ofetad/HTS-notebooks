{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Working with multiple files"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "── Attaching packages ─────────────────────────────────────── tidyverse 1.2.1 ──\n",
      "✔ ggplot2 2.2.1     ✔ purrr   0.2.5\n",
      "✔ tibble  1.4.2     ✔ dplyr   0.7.5\n",
      "✔ tidyr   0.8.1     ✔ stringr 1.3.1\n",
      "✔ readr   1.1.1     ✔ forcats 0.3.0\n",
      "── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n",
      "✖ dplyr::filter() masks stats::filter()\n",
      "✖ dplyr::lag()    masks stats::lag()\n"
     ]
    }
   ],
   "source": [
    "library(tidyverse)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Extended example"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Suppose we have the following scenario:\n",
    "\n",
    "A multi-center experiment is conducted at Duke and UNC.\n",
    "\n",
    "- Duke has patients `Ann`, `Bob`, `Charle`\n",
    "- UNC has patients `David`, `Ed`, `Fiona`\n",
    "- Each patient has blood sampled at 2 time points \n",
    "- The genomics core at each center meausres 3 genes for each patient at each time point\n",
    "- The proteomics core at each cneter measure 3 proteins from each patient at each time point\n",
    "- Each cneter has additional information about patient demographics in a differnet database"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We have a ten files to work with:\n",
    "\n",
    "```\n",
    "duke_demographics.tsv\n",
    "duke_genes_v1.tsv\n",
    "duke_genes_v2.tsv\n",
    "duke_proteins_v1.tsv\n",
    "duke_proteins_v2.tsv\n",
    "unc_demographics.tsv\n",
    "unc_genes_v1.tsv\n",
    "unc_genes_v2.tsv\n",
    "unc_proteins_v1.tsv\n",
    "unc_proteins_v2.tsv\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Objective\n",
    "\n",
    "We want to visualize the correlation between the gene and protein expression changes from visit 1 to visit 2 for all patients in the study. We also want to augment the data with demographic variables for each patient.\n",
    "\n",
    "- Assume that labs within an institutioon do not have batch effects acroos visits\n",
    "- Assume that labs at different instituttions have batch affects and must be normmalized before comparison"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Combine gene expression data from Duke and normalize to zero mean and unit standard devaiotn "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Parsed with column specification:\n",
      "cols(\n",
      "  pet = col_character(),\n",
      "  gene_A = col_double(),\n",
      "  gene_B = col_double(),\n",
      "  gene_C = col_double()\n",
      ")\n",
      "Parsed with column specification:\n",
      "cols(\n",
      "  pet = col_character(),\n",
      "  gene_A = col_double(),\n",
      "  gene_B = col_double(),\n",
      "  gene_C = col_double()\n",
      ")\n"
     ]
    }
   ],
   "source": [
    "df_dg1 <- read_tsv('data/duke_genes_v1.tsv')\n",
    "df_dg2 <- read_tsv('data/duke_genes_v2.tsv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>pet</th><th scope=col>gene_A</th><th scope=col>gene_B</th><th scope=col>gene_C</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>Ann      </td><td> 91.09792</td><td>64.62166 </td><td>124.4608 </td></tr>\n",
       "\t<tr><td>Bob      </td><td> 88.81115</td><td>78.24940 </td><td>113.6644 </td></tr>\n",
       "\t<tr><td>Charlie  </td><td>107.52933</td><td>70.52984 </td><td>124.5951 </td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|llll}\n",
       " pet & gene\\_A & gene\\_B & gene\\_C\\\\\n",
       "\\hline\n",
       "\t Ann       &  91.09792 & 64.62166  & 124.4608 \\\\\n",
       "\t Bob       &  88.81115 & 78.24940  & 113.6644 \\\\\n",
       "\t Charlie   & 107.52933 & 70.52984  & 124.5951 \\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "pet | gene_A | gene_B | gene_C | \n",
       "|---|---|---|\n",
       "| Ann       |  91.09792 | 64.62166  | 124.4608  | \n",
       "| Bob       |  88.81115 | 78.24940  | 113.6644  | \n",
       "| Charlie   | 107.52933 | 70.52984  | 124.5951  | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  pet     gene_A    gene_B   gene_C  \n",
       "1 Ann      91.09792 64.62166 124.4608\n",
       "2 Bob      88.81115 78.24940 113.6644\n",
       "3 Charlie 107.52933 70.52984 124.5951"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_dg1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>pet</th><th scope=col>gene_A</th><th scope=col>gene_B</th><th scope=col>gene_C</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>Ann      </td><td>108.67919</td><td> 90.38630</td><td>137.5395 </td></tr>\n",
       "\t<tr><td>Bob      </td><td>113.44700</td><td>101.52725</td><td>144.7763 </td></tr>\n",
       "\t<tr><td>Charlie  </td><td> 98.12047</td><td> 97.70863</td><td>131.1964 </td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|llll}\n",
       " pet & gene\\_A & gene\\_B & gene\\_C\\\\\n",
       "\\hline\n",
       "\t Ann       & 108.67919 &  90.38630 & 137.5395 \\\\\n",
       "\t Bob       & 113.44700 & 101.52725 & 144.7763 \\\\\n",
       "\t Charlie   &  98.12047 &  97.70863 & 131.1964 \\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "pet | gene_A | gene_B | gene_C | \n",
       "|---|---|---|\n",
       "| Ann       | 108.67919 |  90.38630 | 137.5395  | \n",
       "| Bob       | 113.44700 | 101.52725 | 144.7763  | \n",
       "| Charlie   |  98.12047 |  97.70863 | 131.1964  | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  pet     gene_A    gene_B    gene_C  \n",
       "1 Ann     108.67919  90.38630 137.5395\n",
       "2 Bob     113.44700 101.52725 144.7763\n",
       "3 Charlie  98.12047  97.70863 131.1964"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_dg2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>visit</th><th scope=col>pet</th><th scope=col>gene_A</th><th scope=col>gene_B</th><th scope=col>gene_C</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>1        </td><td>Ann      </td><td> 91.09792</td><td> 64.62166</td><td>124.4608 </td></tr>\n",
       "\t<tr><td>1        </td><td>Bob      </td><td> 88.81115</td><td> 78.24940</td><td>113.6644 </td></tr>\n",
       "\t<tr><td>1        </td><td>Charlie  </td><td>107.52933</td><td> 70.52984</td><td>124.5951 </td></tr>\n",
       "\t<tr><td>2        </td><td>Ann      </td><td>108.67919</td><td> 90.38630</td><td>137.5395 </td></tr>\n",
       "\t<tr><td>2        </td><td>Bob      </td><td>113.44700</td><td>101.52725</td><td>144.7763 </td></tr>\n",
       "\t<tr><td>2        </td><td>Charlie  </td><td> 98.12047</td><td> 97.70863</td><td>131.1964 </td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lllll}\n",
       " visit & pet & gene\\_A & gene\\_B & gene\\_C\\\\\n",
       "\\hline\n",
       "\t 1         & Ann       &  91.09792 &  64.62166 & 124.4608 \\\\\n",
       "\t 1         & Bob       &  88.81115 &  78.24940 & 113.6644 \\\\\n",
       "\t 1         & Charlie   & 107.52933 &  70.52984 & 124.5951 \\\\\n",
       "\t 2         & Ann       & 108.67919 &  90.38630 & 137.5395 \\\\\n",
       "\t 2         & Bob       & 113.44700 & 101.52725 & 144.7763 \\\\\n",
       "\t 2         & Charlie   &  98.12047 &  97.70863 & 131.1964 \\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "visit | pet | gene_A | gene_B | gene_C | \n",
       "|---|---|---|---|---|---|\n",
       "| 1         | Ann       |  91.09792 |  64.62166 | 124.4608  | \n",
       "| 1         | Bob       |  88.81115 |  78.24940 | 113.6644  | \n",
       "| 1         | Charlie   | 107.52933 |  70.52984 | 124.5951  | \n",
       "| 2         | Ann       | 108.67919 |  90.38630 | 137.5395  | \n",
       "| 2         | Bob       | 113.44700 | 101.52725 | 144.7763  | \n",
       "| 2         | Charlie   |  98.12047 |  97.70863 | 131.1964  | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  visit pet     gene_A    gene_B    gene_C  \n",
       "1 1     Ann      91.09792  64.62166 124.4608\n",
       "2 1     Bob      88.81115  78.24940 113.6644\n",
       "3 1     Charlie 107.52933  70.52984 124.5951\n",
       "4 2     Ann     108.67919  90.38630 137.5395\n",
       "5 2     Bob     113.44700 101.52725 144.7763\n",
       "6 2     Charlie  98.12047  97.70863 131.1964"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_dg <- bind_rows(df_dg1, df_dg2, .id = \"visit\")\n",
    "df_dg"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>visit</th><th scope=col>pet</th><th scope=col>gene_A</th><th scope=col>gene_B</th><th scope=col>gene_C</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>1         </td><td>Ann       </td><td>-1.0073042</td><td>-1.2805845</td><td>-0.4479685</td></tr>\n",
       "\t<tr><td>1         </td><td>Bob       </td><td>-1.2335142</td><td>-0.3723877</td><td>-1.4327190</td></tr>\n",
       "\t<tr><td>1         </td><td>Charlie   </td><td> 0.6181059</td><td>-0.8868438</td><td>-0.4357137</td></tr>\n",
       "\t<tr><td>2         </td><td>Ann       </td><td> 0.7318518</td><td> 0.4364545</td><td> 0.7449587</td></tr>\n",
       "\t<tr><td>2         </td><td>Bob       </td><td> 1.2034879</td><td> 1.1789234</td><td> 1.4050414</td></tr>\n",
       "\t<tr><td>2         </td><td>Charlie   </td><td>-0.3126272</td><td> 0.9244382</td><td> 0.1664011</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lllll}\n",
       " visit & pet & gene\\_A & gene\\_B & gene\\_C\\\\\n",
       "\\hline\n",
       "\t 1          & Ann        & -1.0073042 & -1.2805845 & -0.4479685\\\\\n",
       "\t 1          & Bob        & -1.2335142 & -0.3723877 & -1.4327190\\\\\n",
       "\t 1          & Charlie    &  0.6181059 & -0.8868438 & -0.4357137\\\\\n",
       "\t 2          & Ann        &  0.7318518 &  0.4364545 &  0.7449587\\\\\n",
       "\t 2          & Bob        &  1.2034879 &  1.1789234 &  1.4050414\\\\\n",
       "\t 2          & Charlie    & -0.3126272 &  0.9244382 &  0.1664011\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "visit | pet | gene_A | gene_B | gene_C | \n",
       "|---|---|---|---|---|---|\n",
       "| 1          | Ann        | -1.0073042 | -1.2805845 | -0.4479685 | \n",
       "| 1          | Bob        | -1.2335142 | -0.3723877 | -1.4327190 | \n",
       "| 1          | Charlie    |  0.6181059 | -0.8868438 | -0.4357137 | \n",
       "| 2          | Ann        |  0.7318518 |  0.4364545 |  0.7449587 | \n",
       "| 2          | Bob        |  1.2034879 |  1.1789234 |  1.4050414 | \n",
       "| 2          | Charlie    | -0.3126272 |  0.9244382 |  0.1664011 | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  visit pet     gene_A     gene_B     gene_C    \n",
       "1 1     Ann     -1.0073042 -1.2805845 -0.4479685\n",
       "2 1     Bob     -1.2335142 -0.3723877 -1.4327190\n",
       "3 1     Charlie  0.6181059 -0.8868438 -0.4357137\n",
       "4 2     Ann      0.7318518  0.4364545  0.7449587\n",
       "5 2     Bob      1.2034879  1.1789234  1.4050414\n",
       "6 2     Charlie -0.3126272  0.9244382  0.1664011"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_dg.scaled <- df_dg  %>% mutate_if(is.numeric, scale)\n",
    "df_dg.scaled"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Do the same for the other data sets"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Duke protein expression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Parsed with column specification:\n",
      "cols(\n",
      "  pet = col_character(),\n",
      "  prot_A = col_double(),\n",
      "  prot_B = col_double(),\n",
      "  prot_C = col_double()\n",
      ")\n",
      "Parsed with column specification:\n",
      "cols(\n",
      "  pet = col_character(),\n",
      "  prot_A = col_double(),\n",
      "  prot_B = col_double(),\n",
      "  prot_C = col_double()\n",
      ")\n"
     ]
    }
   ],
   "source": [
    "df_dp1 <- read_tsv('data/duke_proteins_v1.tsv')\n",
    "df_dp2 <- read_tsv('data/duke_proteins_v2.tsv')\n",
    "df_dp <- bind_rows(df_dp1, df_dp2, .id = \"visit\")\n",
    "df_dp.scaled <- df_dp %>%  mutate_if(is.numeric, scale)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>visit</th><th scope=col>pet</th><th scope=col>prot_A</th><th scope=col>prot_B</th><th scope=col>prot_C</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>1          </td><td>Ann        </td><td>-0.4967020 </td><td> 0.9830005 </td><td>-1.37774584</td></tr>\n",
       "\t<tr><td>1          </td><td>Bob        </td><td>-1.0132844 </td><td>-1.1799912 </td><td>-1.01496776</td></tr>\n",
       "\t<tr><td>1          </td><td>Charlie    </td><td>-0.3455620 </td><td>-0.8561590 </td><td> 0.60497113</td></tr>\n",
       "\t<tr><td>2          </td><td>Ann        </td><td>-0.4191436 </td><td> 0.3772850 </td><td> 0.88392265</td></tr>\n",
       "\t<tr><td>2          </td><td>Bob        </td><td> 1.7870904 </td><td>-0.5388750 </td><td>-0.05597907</td></tr>\n",
       "\t<tr><td>2          </td><td>Charlie    </td><td> 0.4876017 </td><td> 1.2147397 </td><td> 0.95979888</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lllll}\n",
       " visit & pet & prot\\_A & prot\\_B & prot\\_C\\\\\n",
       "\\hline\n",
       "\t 1           & Ann         & -0.4967020  &  0.9830005  & -1.37774584\\\\\n",
       "\t 1           & Bob         & -1.0132844  & -1.1799912  & -1.01496776\\\\\n",
       "\t 1           & Charlie     & -0.3455620  & -0.8561590  &  0.60497113\\\\\n",
       "\t 2           & Ann         & -0.4191436  &  0.3772850  &  0.88392265\\\\\n",
       "\t 2           & Bob         &  1.7870904  & -0.5388750  & -0.05597907\\\\\n",
       "\t 2           & Charlie     &  0.4876017  &  1.2147397  &  0.95979888\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "visit | pet | prot_A | prot_B | prot_C | \n",
       "|---|---|---|---|---|---|\n",
       "| 1           | Ann         | -0.4967020  |  0.9830005  | -1.37774584 | \n",
       "| 1           | Bob         | -1.0132844  | -1.1799912  | -1.01496776 | \n",
       "| 1           | Charlie     | -0.3455620  | -0.8561590  |  0.60497113 | \n",
       "| 2           | Ann         | -0.4191436  |  0.3772850  |  0.88392265 | \n",
       "| 2           | Bob         |  1.7870904  | -0.5388750  | -0.05597907 | \n",
       "| 2           | Charlie     |  0.4876017  |  1.2147397  |  0.95979888 | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  visit pet     prot_A     prot_B     prot_C     \n",
       "1 1     Ann     -0.4967020  0.9830005 -1.37774584\n",
       "2 1     Bob     -1.0132844 -1.1799912 -1.01496776\n",
       "3 1     Charlie -0.3455620 -0.8561590  0.60497113\n",
       "4 2     Ann     -0.4191436  0.3772850  0.88392265\n",
       "5 2     Bob      1.7870904 -0.5388750 -0.05597907\n",
       "6 2     Charlie  0.4876017  1.2147397  0.95979888"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "head(df_dp.scaled)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "UNC gene expression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Parsed with column specification:\n",
      "cols(\n",
      "  pet = col_character(),\n",
      "  gene_A = col_double(),\n",
      "  gene_B = col_double(),\n",
      "  gene_C = col_double()\n",
      ")\n",
      "Parsed with column specification:\n",
      "cols(\n",
      "  pet = col_character(),\n",
      "  gene_A = col_double(),\n",
      "  gene_B = col_double(),\n",
      "  gene_C = col_double()\n",
      ")\n"
     ]
    }
   ],
   "source": [
    "df_ug1 <- read_tsv('data/unc_genes_v1.tsv')\n",
    "df_ug2 <- read_tsv('data/unc_genes_v2.tsv')\n",
    "df_ug <- bind_rows(df_ug1, df_ug2, .id = \"visit\")\n",
    "df_ug.scaled <- df_ug %>%  mutate_if(is.numeric, scale)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>visit</th><th scope=col>pet</th><th scope=col>gene_A</th><th scope=col>gene_B</th><th scope=col>gene_C</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>1          </td><td>David      </td><td>-0.59425311</td><td>-1.2262407 </td><td>-0.30771429</td></tr>\n",
       "\t<tr><td>1          </td><td>Ed         </td><td>-1.17645232</td><td>-0.5087640 </td><td> 0.02835355</td></tr>\n",
       "\t<tr><td>1          </td><td>Fiona      </td><td> 0.36658576</td><td>-0.3217073 </td><td>-1.82700451</td></tr>\n",
       "\t<tr><td>2          </td><td>David      </td><td> 0.08382534</td><td> 0.5735718 </td><td> 0.66994801</td></tr>\n",
       "\t<tr><td>2          </td><td>Ed         </td><td>-0.40047124</td><td>-0.1817827 </td><td> 0.92567540</td></tr>\n",
       "\t<tr><td>2          </td><td>Fiona      </td><td> 1.72076557</td><td> 1.6649228 </td><td> 0.51074184</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lllll}\n",
       " visit & pet & gene\\_A & gene\\_B & gene\\_C\\\\\n",
       "\\hline\n",
       "\t 1           & David       & -0.59425311 & -1.2262407  & -0.30771429\\\\\n",
       "\t 1           & Ed          & -1.17645232 & -0.5087640  &  0.02835355\\\\\n",
       "\t 1           & Fiona       &  0.36658576 & -0.3217073  & -1.82700451\\\\\n",
       "\t 2           & David       &  0.08382534 &  0.5735718  &  0.66994801\\\\\n",
       "\t 2           & Ed          & -0.40047124 & -0.1817827  &  0.92567540\\\\\n",
       "\t 2           & Fiona       &  1.72076557 &  1.6649228  &  0.51074184\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "visit | pet | gene_A | gene_B | gene_C | \n",
       "|---|---|---|---|---|---|\n",
       "| 1           | David       | -0.59425311 | -1.2262407  | -0.30771429 | \n",
       "| 1           | Ed          | -1.17645232 | -0.5087640  |  0.02835355 | \n",
       "| 1           | Fiona       |  0.36658576 | -0.3217073  | -1.82700451 | \n",
       "| 2           | David       |  0.08382534 |  0.5735718  |  0.66994801 | \n",
       "| 2           | Ed          | -0.40047124 | -0.1817827  |  0.92567540 | \n",
       "| 2           | Fiona       |  1.72076557 |  1.6649228  |  0.51074184 | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  visit pet   gene_A      gene_B     gene_C     \n",
       "1 1     David -0.59425311 -1.2262407 -0.30771429\n",
       "2 1     Ed    -1.17645232 -0.5087640  0.02835355\n",
       "3 1     Fiona  0.36658576 -0.3217073 -1.82700451\n",
       "4 2     David  0.08382534  0.5735718  0.66994801\n",
       "5 2     Ed    -0.40047124 -0.1817827  0.92567540\n",
       "6 2     Fiona  1.72076557  1.6649228  0.51074184"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "head(df_ug.scaled)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "UNC protein expression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Parsed with column specification:\n",
      "cols(\n",
      "  pet = col_character(),\n",
      "  prot_A = col_double(),\n",
      "  prot_B = col_double(),\n",
      "  prot_C = col_double()\n",
      ")\n",
      "Parsed with column specification:\n",
      "cols(\n",
      "  pet = col_character(),\n",
      "  prot_A = col_double(),\n",
      "  prot_B = col_double(),\n",
      "  prot_C = col_double()\n",
      ")\n"
     ]
    }
   ],
   "source": [
    "df_up1 <- read_tsv('data/unc_proteins_v1.tsv')\n",
    "df_up2 <- read_tsv('data/unc_proteins_v2.tsv')\n",
    "df_up <- bind_rows(df_up1, df_up2, .id = \"visit\")\n",
    "df_up.scaled <- df_up %>%  mutate_if(is.numeric, scale)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>visit</th><th scope=col>pet</th><th scope=col>prot_A</th><th scope=col>prot_B</th><th scope=col>prot_C</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>1          </td><td>David      </td><td> 1.04580136</td><td> 0.1280673 </td><td>-0.6867668 </td></tr>\n",
       "\t<tr><td>1          </td><td>Ed         </td><td>-1.65977553</td><td> 0.2117860 </td><td> 0.9772767 </td></tr>\n",
       "\t<tr><td>1          </td><td>Fiona      </td><td> 0.05811210</td><td>-0.6413509 </td><td>-1.4593511 </td></tr>\n",
       "\t<tr><td>2          </td><td>David      </td><td>-0.44575884</td><td>-0.7384114 </td><td> 0.9175770 </td></tr>\n",
       "\t<tr><td>2          </td><td>Ed         </td><td> 0.02765904</td><td> 1.8317201 </td><td> 0.6595148 </td></tr>\n",
       "\t<tr><td>2          </td><td>Fiona      </td><td> 0.97396187</td><td>-0.7918110 </td><td>-0.4082508 </td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lllll}\n",
       " visit & pet & prot\\_A & prot\\_B & prot\\_C\\\\\n",
       "\\hline\n",
       "\t 1           & David       &  1.04580136 &  0.1280673  & -0.6867668 \\\\\n",
       "\t 1           & Ed          & -1.65977553 &  0.2117860  &  0.9772767 \\\\\n",
       "\t 1           & Fiona       &  0.05811210 & -0.6413509  & -1.4593511 \\\\\n",
       "\t 2           & David       & -0.44575884 & -0.7384114  &  0.9175770 \\\\\n",
       "\t 2           & Ed          &  0.02765904 &  1.8317201  &  0.6595148 \\\\\n",
       "\t 2           & Fiona       &  0.97396187 & -0.7918110  & -0.4082508 \\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "visit | pet | prot_A | prot_B | prot_C | \n",
       "|---|---|---|---|---|---|\n",
       "| 1           | David       |  1.04580136 |  0.1280673  | -0.6867668  | \n",
       "| 1           | Ed          | -1.65977553 |  0.2117860  |  0.9772767  | \n",
       "| 1           | Fiona       |  0.05811210 | -0.6413509  | -1.4593511  | \n",
       "| 2           | David       | -0.44575884 | -0.7384114  |  0.9175770  | \n",
       "| 2           | Ed          |  0.02765904 |  1.8317201  |  0.6595148  | \n",
       "| 2           | Fiona       |  0.97396187 | -0.7918110  | -0.4082508  | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  visit pet   prot_A      prot_B     prot_C    \n",
       "1 1     David  1.04580136  0.1280673 -0.6867668\n",
       "2 1     Ed    -1.65977553  0.2117860  0.9772767\n",
       "3 1     Fiona  0.05811210 -0.6413509 -1.4593511\n",
       "4 2     David -0.44575884 -0.7384114  0.9175770\n",
       "5 2     Ed     0.02765904  1.8317201  0.6595148\n",
       "6 2     Fiona  0.97396187 -0.7918110 -0.4082508"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "head(df_up.scaled)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Fidn the change in each gene from visit 1 to visit 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>visit</th><th scope=col>pet</th><th scope=col>gene_A</th><th scope=col>gene_B</th><th scope=col>gene_C</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>1         </td><td>Ann       </td><td>-1.0073042</td><td>-1.2805845</td><td>-0.4479685</td></tr>\n",
       "\t<tr><td>1         </td><td>Bob       </td><td>-1.2335142</td><td>-0.3723877</td><td>-1.4327190</td></tr>\n",
       "\t<tr><td>1         </td><td>Charlie   </td><td> 0.6181059</td><td>-0.8868438</td><td>-0.4357137</td></tr>\n",
       "\t<tr><td>2         </td><td>Ann       </td><td> 0.7318518</td><td> 0.4364545</td><td> 0.7449587</td></tr>\n",
       "\t<tr><td>2         </td><td>Bob       </td><td> 1.2034879</td><td> 1.1789234</td><td> 1.4050414</td></tr>\n",
       "\t<tr><td>2         </td><td>Charlie   </td><td>-0.3126272</td><td> 0.9244382</td><td> 0.1664011</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lllll}\n",
       " visit & pet & gene\\_A & gene\\_B & gene\\_C\\\\\n",
       "\\hline\n",
       "\t 1          & Ann        & -1.0073042 & -1.2805845 & -0.4479685\\\\\n",
       "\t 1          & Bob        & -1.2335142 & -0.3723877 & -1.4327190\\\\\n",
       "\t 1          & Charlie    &  0.6181059 & -0.8868438 & -0.4357137\\\\\n",
       "\t 2          & Ann        &  0.7318518 &  0.4364545 &  0.7449587\\\\\n",
       "\t 2          & Bob        &  1.2034879 &  1.1789234 &  1.4050414\\\\\n",
       "\t 2          & Charlie    & -0.3126272 &  0.9244382 &  0.1664011\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "visit | pet | gene_A | gene_B | gene_C | \n",
       "|---|---|---|---|---|---|\n",
       "| 1          | Ann        | -1.0073042 | -1.2805845 | -0.4479685 | \n",
       "| 1          | Bob        | -1.2335142 | -0.3723877 | -1.4327190 | \n",
       "| 1          | Charlie    |  0.6181059 | -0.8868438 | -0.4357137 | \n",
       "| 2          | Ann        |  0.7318518 |  0.4364545 |  0.7449587 | \n",
       "| 2          | Bob        |  1.2034879 |  1.1789234 |  1.4050414 | \n",
       "| 2          | Charlie    | -0.3126272 |  0.9244382 |  0.1664011 | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  visit pet     gene_A     gene_B     gene_C    \n",
       "1 1     Ann     -1.0073042 -1.2805845 -0.4479685\n",
       "2 1     Bob     -1.2335142 -0.3723877 -1.4327190\n",
       "3 1     Charlie  0.6181059 -0.8868438 -0.4357137\n",
       "4 2     Ann      0.7318518  0.4364545  0.7449587\n",
       "5 2     Bob      1.2034879  1.1789234  1.4050414\n",
       "6 2     Charlie -0.3126272  0.9244382  0.1664011"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_dg.scaled"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "metadata": {},
   "outputs": [],
   "source": [
    "# To avoid a bunch or harmless warnigns, we will temprarily suppress them\n",
    "\n",
    "options(warn=-1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>visit</th><th scope=col>pet</th><th scope=col>gene</th><th scope=col>value</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>1         </td><td>Ann       </td><td>gene_A    </td><td>-1.0073042</td></tr>\n",
       "\t<tr><td>1         </td><td>Bob       </td><td>gene_A    </td><td>-1.2335142</td></tr>\n",
       "\t<tr><td>1         </td><td>Charlie   </td><td>gene_A    </td><td> 0.6181059</td></tr>\n",
       "\t<tr><td>2         </td><td>Ann       </td><td>gene_A    </td><td> 0.7318518</td></tr>\n",
       "\t<tr><td>2         </td><td>Bob       </td><td>gene_A    </td><td> 1.2034879</td></tr>\n",
       "\t<tr><td>2         </td><td>Charlie   </td><td>gene_A    </td><td>-0.3126272</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|llll}\n",
       " visit & pet & gene & value\\\\\n",
       "\\hline\n",
       "\t 1          & Ann        & gene\\_A   & -1.0073042\\\\\n",
       "\t 1          & Bob        & gene\\_A   & -1.2335142\\\\\n",
       "\t 1          & Charlie    & gene\\_A   &  0.6181059\\\\\n",
       "\t 2          & Ann        & gene\\_A   &  0.7318518\\\\\n",
       "\t 2          & Bob        & gene\\_A   &  1.2034879\\\\\n",
       "\t 2          & Charlie    & gene\\_A   & -0.3126272\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "visit | pet | gene | value | \n",
       "|---|---|---|---|---|---|\n",
       "| 1          | Ann        | gene_A     | -1.0073042 | \n",
       "| 1          | Bob        | gene_A     | -1.2335142 | \n",
       "| 1          | Charlie    | gene_A     |  0.6181059 | \n",
       "| 2          | Ann        | gene_A     |  0.7318518 | \n",
       "| 2          | Bob        | gene_A     |  1.2034879 | \n",
       "| 2          | Charlie    | gene_A     | -0.3126272 | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  visit pet     gene   value     \n",
       "1 1     Ann     gene_A -1.0073042\n",
       "2 1     Bob     gene_A -1.2335142\n",
       "3 1     Charlie gene_A  0.6181059\n",
       "4 2     Ann     gene_A  0.7318518\n",
       "5 2     Bob     gene_A  1.2034879\n",
       "6 2     Charlie gene_A -0.3126272"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_dg.scaled %>% \n",
    "gather(gene, value, starts_with('gene'))  %>% \n",
    "head"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>pet</th><th scope=col>gene</th><th scope=col>1</th><th scope=col>2</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>Ann       </td><td>gene_A    </td><td>-1.0073042</td><td>0.7318518 </td></tr>\n",
       "\t<tr><td>Ann       </td><td>gene_B    </td><td>-1.2805845</td><td>0.4364545 </td></tr>\n",
       "\t<tr><td>Ann       </td><td>gene_C    </td><td>-0.4479685</td><td>0.7449587 </td></tr>\n",
       "\t<tr><td>Bob       </td><td>gene_A    </td><td>-1.2335142</td><td>1.2034879 </td></tr>\n",
       "\t<tr><td>Bob       </td><td>gene_B    </td><td>-0.3723877</td><td>1.1789234 </td></tr>\n",
       "\t<tr><td>Bob       </td><td>gene_C    </td><td>-1.4327190</td><td>1.4050414 </td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|llll}\n",
       " pet & gene & 1 & 2\\\\\n",
       "\\hline\n",
       "\t Ann        & gene\\_A   & -1.0073042 & 0.7318518 \\\\\n",
       "\t Ann        & gene\\_B   & -1.2805845 & 0.4364545 \\\\\n",
       "\t Ann        & gene\\_C   & -0.4479685 & 0.7449587 \\\\\n",
       "\t Bob        & gene\\_A   & -1.2335142 & 1.2034879 \\\\\n",
       "\t Bob        & gene\\_B   & -0.3723877 & 1.1789234 \\\\\n",
       "\t Bob        & gene\\_C   & -1.4327190 & 1.4050414 \\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "pet | gene | 1 | 2 | \n",
       "|---|---|---|---|---|---|\n",
       "| Ann        | gene_A     | -1.0073042 | 0.7318518  | \n",
       "| Ann        | gene_B     | -1.2805845 | 0.4364545  | \n",
       "| Ann        | gene_C     | -0.4479685 | 0.7449587  | \n",
       "| Bob        | gene_A     | -1.2335142 | 1.2034879  | \n",
       "| Bob        | gene_B     | -0.3723877 | 1.1789234  | \n",
       "| Bob        | gene_C     | -1.4327190 | 1.4050414  | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  pet gene   1          2        \n",
       "1 Ann gene_A -1.0073042 0.7318518\n",
       "2 Ann gene_B -1.2805845 0.4364545\n",
       "3 Ann gene_C -0.4479685 0.7449587\n",
       "4 Bob gene_A -1.2335142 1.2034879\n",
       "5 Bob gene_B -0.3723877 1.1789234\n",
       "6 Bob gene_C -1.4327190 1.4050414"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_dg.scaled %>% \n",
    "gather(gene, value, starts_with('gene'))  %>% \n",
    "spread(visit, value) %>%\n",
    "head"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>patient</th><th scope=col>gene</th><th scope=col>gene.change</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>Ann     </td><td>A       </td><td>1.739156</td></tr>\n",
       "\t<tr><td>Ann     </td><td>B       </td><td>1.717039</td></tr>\n",
       "\t<tr><td>Ann     </td><td>C       </td><td>1.192927</td></tr>\n",
       "\t<tr><td>Bob     </td><td>A       </td><td>2.437002</td></tr>\n",
       "\t<tr><td>Bob     </td><td>B       </td><td>1.551311</td></tr>\n",
       "\t<tr><td>Bob     </td><td>C       </td><td>2.837760</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lll}\n",
       " patient & gene & gene.change\\\\\n",
       "\\hline\n",
       "\t Ann      & A        & 1.739156\\\\\n",
       "\t Ann      & B        & 1.717039\\\\\n",
       "\t Ann      & C        & 1.192927\\\\\n",
       "\t Bob      & A        & 2.437002\\\\\n",
       "\t Bob      & B        & 1.551311\\\\\n",
       "\t Bob      & C        & 2.837760\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "patient | gene | gene.change | \n",
       "|---|---|---|---|---|---|\n",
       "| Ann      | A        | 1.739156 | \n",
       "| Ann      | B        | 1.717039 | \n",
       "| Ann      | C        | 1.192927 | \n",
       "| Bob      | A        | 2.437002 | \n",
       "| Bob      | B        | 1.551311 | \n",
       "| Bob      | C        | 2.837760 | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  patient gene gene.change\n",
       "1 Ann     A    1.739156   \n",
       "2 Ann     B    1.717039   \n",
       "3 Ann     C    1.192927   \n",
       "4 Bob     A    2.437002   \n",
       "5 Bob     B    1.551311   \n",
       "6 Bob     C    2.837760   "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_dg.diff <- df_dg.scaled %>% \n",
    "gather(gene, value, starts_with('gene'))  %>% \n",
    "spread(visit, value) %>%\n",
    "transmute(patient=pet, \n",
    "          gene=str_extract(gene, '[^_]+$'), \n",
    "          gene.change=`2`-`1`)\n",
    "head(df_dg.diff)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Combine with UNC data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 99,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>patient</th><th scope=col>gene</th><th scope=col>gene.change</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>David    </td><td>A        </td><td>0.6780785</td></tr>\n",
       "\t<tr><td>David    </td><td>B        </td><td>1.7998124</td></tr>\n",
       "\t<tr><td>David    </td><td>C        </td><td>0.9776623</td></tr>\n",
       "\t<tr><td>Ed       </td><td>A        </td><td>0.7759811</td></tr>\n",
       "\t<tr><td>Ed       </td><td>B        </td><td>0.3269814</td></tr>\n",
       "\t<tr><td>Ed       </td><td>C        </td><td>0.8973218</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lll}\n",
       " patient & gene & gene.change\\\\\n",
       "\\hline\n",
       "\t David     & A         & 0.6780785\\\\\n",
       "\t David     & B         & 1.7998124\\\\\n",
       "\t David     & C         & 0.9776623\\\\\n",
       "\t Ed        & A         & 0.7759811\\\\\n",
       "\t Ed        & B         & 0.3269814\\\\\n",
       "\t Ed        & C         & 0.8973218\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "patient | gene | gene.change | \n",
       "|---|---|---|---|---|---|\n",
       "| David     | A         | 0.6780785 | \n",
       "| David     | B         | 1.7998124 | \n",
       "| David     | C         | 0.9776623 | \n",
       "| Ed        | A         | 0.7759811 | \n",
       "| Ed        | B         | 0.3269814 | \n",
       "| Ed        | C         | 0.8973218 | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  patient gene gene.change\n",
       "1 David   A    0.6780785  \n",
       "2 David   B    1.7998124  \n",
       "3 David   C    0.9776623  \n",
       "4 Ed      A    0.7759811  \n",
       "5 Ed      B    0.3269814  \n",
       "6 Ed      C    0.8973218  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_ug.diff <- df_ug.scaled %>% \n",
    "gather(gene, value, starts_with('gene'))  %>% \n",
    "spread(visit, value) %>%\n",
    "transmute(patient=pet, \n",
    "          gene=str_extract(gene, '[^_]+$'), \n",
    "          gene.change=`2`-`1`)\n",
    "head(df_ug.diff)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 103,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>site</th><th scope=col>patient</th><th scope=col>gene</th><th scope=col>gene.change</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>duke      </td><td>Ann       </td><td>A         </td><td> 1.7391560</td></tr>\n",
       "\t<tr><td>duke      </td><td>Ann       </td><td>B         </td><td> 1.7170389</td></tr>\n",
       "\t<tr><td>duke      </td><td>Ann       </td><td>C         </td><td> 1.1929272</td></tr>\n",
       "\t<tr><td>duke      </td><td>Bob       </td><td>A         </td><td> 2.4370022</td></tr>\n",
       "\t<tr><td>duke      </td><td>Bob       </td><td>B         </td><td> 1.5513112</td></tr>\n",
       "\t<tr><td>duke      </td><td>Bob       </td><td>C         </td><td> 2.8377604</td></tr>\n",
       "\t<tr><td>duke      </td><td>Charlie   </td><td>A         </td><td>-0.9307330</td></tr>\n",
       "\t<tr><td>duke      </td><td>Charlie   </td><td>B         </td><td> 1.8112820</td></tr>\n",
       "\t<tr><td>duke      </td><td>Charlie   </td><td>C         </td><td> 0.6021148</td></tr>\n",
       "\t<tr><td>unc       </td><td>David     </td><td>A         </td><td> 0.6780785</td></tr>\n",
       "\t<tr><td>unc       </td><td>David     </td><td>B         </td><td> 1.7998124</td></tr>\n",
       "\t<tr><td>unc       </td><td>David     </td><td>C         </td><td> 0.9776623</td></tr>\n",
       "\t<tr><td>unc       </td><td>Ed        </td><td>A         </td><td> 0.7759811</td></tr>\n",
       "\t<tr><td>unc       </td><td>Ed        </td><td>B         </td><td> 0.3269814</td></tr>\n",
       "\t<tr><td>unc       </td><td>Ed        </td><td>C         </td><td> 0.8973218</td></tr>\n",
       "\t<tr><td>unc       </td><td>Fiona     </td><td>A         </td><td> 1.3541798</td></tr>\n",
       "\t<tr><td>unc       </td><td>Fiona     </td><td>B         </td><td> 1.9866301</td></tr>\n",
       "\t<tr><td>unc       </td><td>Fiona     </td><td>C         </td><td> 2.3377464</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|llll}\n",
       " site & patient & gene & gene.change\\\\\n",
       "\\hline\n",
       "\t duke       & Ann        & A          &  1.7391560\\\\\n",
       "\t duke       & Ann        & B          &  1.7170389\\\\\n",
       "\t duke       & Ann        & C          &  1.1929272\\\\\n",
       "\t duke       & Bob        & A          &  2.4370022\\\\\n",
       "\t duke       & Bob        & B          &  1.5513112\\\\\n",
       "\t duke       & Bob        & C          &  2.8377604\\\\\n",
       "\t duke       & Charlie    & A          & -0.9307330\\\\\n",
       "\t duke       & Charlie    & B          &  1.8112820\\\\\n",
       "\t duke       & Charlie    & C          &  0.6021148\\\\\n",
       "\t unc        & David      & A          &  0.6780785\\\\\n",
       "\t unc        & David      & B          &  1.7998124\\\\\n",
       "\t unc        & David      & C          &  0.9776623\\\\\n",
       "\t unc        & Ed         & A          &  0.7759811\\\\\n",
       "\t unc        & Ed         & B          &  0.3269814\\\\\n",
       "\t unc        & Ed         & C          &  0.8973218\\\\\n",
       "\t unc        & Fiona      & A          &  1.3541798\\\\\n",
       "\t unc        & Fiona      & B          &  1.9866301\\\\\n",
       "\t unc        & Fiona      & C          &  2.3377464\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "site | patient | gene | gene.change | \n",
       "|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n",
       "| duke       | Ann        | A          |  1.7391560 | \n",
       "| duke       | Ann        | B          |  1.7170389 | \n",
       "| duke       | Ann        | C          |  1.1929272 | \n",
       "| duke       | Bob        | A          |  2.4370022 | \n",
       "| duke       | Bob        | B          |  1.5513112 | \n",
       "| duke       | Bob        | C          |  2.8377604 | \n",
       "| duke       | Charlie    | A          | -0.9307330 | \n",
       "| duke       | Charlie    | B          |  1.8112820 | \n",
       "| duke       | Charlie    | C          |  0.6021148 | \n",
       "| unc        | David      | A          |  0.6780785 | \n",
       "| unc        | David      | B          |  1.7998124 | \n",
       "| unc        | David      | C          |  0.9776623 | \n",
       "| unc        | Ed         | A          |  0.7759811 | \n",
       "| unc        | Ed         | B          |  0.3269814 | \n",
       "| unc        | Ed         | C          |  0.8973218 | \n",
       "| unc        | Fiona      | A          |  1.3541798 | \n",
       "| unc        | Fiona      | B          |  1.9866301 | \n",
       "| unc        | Fiona      | C          |  2.3377464 | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "   site patient gene gene.change\n",
       "1  duke Ann     A     1.7391560 \n",
       "2  duke Ann     B     1.7170389 \n",
       "3  duke Ann     C     1.1929272 \n",
       "4  duke Bob     A     2.4370022 \n",
       "5  duke Bob     B     1.5513112 \n",
       "6  duke Bob     C     2.8377604 \n",
       "7  duke Charlie A    -0.9307330 \n",
       "8  duke Charlie B     1.8112820 \n",
       "9  duke Charlie C     0.6021148 \n",
       "10 unc  David   A     0.6780785 \n",
       "11 unc  David   B     1.7998124 \n",
       "12 unc  David   C     0.9776623 \n",
       "13 unc  Ed      A     0.7759811 \n",
       "14 unc  Ed      B     0.3269814 \n",
       "15 unc  Ed      C     0.8973218 \n",
       "16 unc  Fiona   A     1.3541798 \n",
       "17 unc  Fiona   B     1.9866301 \n",
       "18 unc  Fiona   C     2.3377464 "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_g <- bind_rows(list(duke=df_dg.diff, unc=df_ug.diff), .id='site')\n",
    "df_g"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Now do the same with protein data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 104,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>patient</th><th scope=col>protein</th><th scope=col>protein.change</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>Ann        </td><td>A          </td><td> 0.07755833</td></tr>\n",
       "\t<tr><td>Ann        </td><td>B          </td><td>-0.60571547</td></tr>\n",
       "\t<tr><td>Ann        </td><td>C          </td><td> 2.26166848</td></tr>\n",
       "\t<tr><td>Bob        </td><td>A          </td><td> 2.80037479</td></tr>\n",
       "\t<tr><td>Bob        </td><td>B          </td><td> 0.64111624</td></tr>\n",
       "\t<tr><td>Bob        </td><td>C          </td><td> 0.95898869</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lll}\n",
       " patient & protein & protein.change\\\\\n",
       "\\hline\n",
       "\t Ann         & A           &  0.07755833\\\\\n",
       "\t Ann         & B           & -0.60571547\\\\\n",
       "\t Ann         & C           &  2.26166848\\\\\n",
       "\t Bob         & A           &  2.80037479\\\\\n",
       "\t Bob         & B           &  0.64111624\\\\\n",
       "\t Bob         & C           &  0.95898869\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "patient | protein | protein.change | \n",
       "|---|---|---|---|---|---|\n",
       "| Ann         | A           |  0.07755833 | \n",
       "| Ann         | B           | -0.60571547 | \n",
       "| Ann         | C           |  2.26166848 | \n",
       "| Bob         | A           |  2.80037479 | \n",
       "| Bob         | B           |  0.64111624 | \n",
       "| Bob         | C           |  0.95898869 | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  patient protein protein.change\n",
       "1 Ann     A        0.07755833   \n",
       "2 Ann     B       -0.60571547   \n",
       "3 Ann     C        2.26166848   \n",
       "4 Bob     A        2.80037479   \n",
       "5 Bob     B        0.64111624   \n",
       "6 Bob     C        0.95898869   "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_dp.diff <- df_dp.scaled %>% \n",
    "gather(protein, value, starts_with('prot'))  %>% \n",
    "spread(visit, value) %>%\n",
    "transmute(patient=pet, \n",
    "          protein=str_extract(protein, '[^_]+$'), \n",
    "          protein.change=`2`-`1`)\n",
    "head(df_dp.diff)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>patient</th><th scope=col>protein</th><th scope=col>protein.change</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>David     </td><td>A         </td><td>-1.4915602</td></tr>\n",
       "\t<tr><td>David     </td><td>B         </td><td>-0.8664787</td></tr>\n",
       "\t<tr><td>David     </td><td>C         </td><td> 1.6043438</td></tr>\n",
       "\t<tr><td>Ed        </td><td>A         </td><td> 1.6874346</td></tr>\n",
       "\t<tr><td>Ed        </td><td>B         </td><td> 1.6199340</td></tr>\n",
       "\t<tr><td>Ed        </td><td>C         </td><td>-0.3177619</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lll}\n",
       " patient & protein & protein.change\\\\\n",
       "\\hline\n",
       "\t David      & A          & -1.4915602\\\\\n",
       "\t David      & B          & -0.8664787\\\\\n",
       "\t David      & C          &  1.6043438\\\\\n",
       "\t Ed         & A          &  1.6874346\\\\\n",
       "\t Ed         & B          &  1.6199340\\\\\n",
       "\t Ed         & C          & -0.3177619\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "patient | protein | protein.change | \n",
       "|---|---|---|---|---|---|\n",
       "| David      | A          | -1.4915602 | \n",
       "| David      | B          | -0.8664787 | \n",
       "| David      | C          |  1.6043438 | \n",
       "| Ed         | A          |  1.6874346 | \n",
       "| Ed         | B          |  1.6199340 | \n",
       "| Ed         | C          | -0.3177619 | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  patient protein protein.change\n",
       "1 David   A       -1.4915602    \n",
       "2 David   B       -0.8664787    \n",
       "3 David   C        1.6043438    \n",
       "4 Ed      A        1.6874346    \n",
       "5 Ed      B        1.6199340    \n",
       "6 Ed      C       -0.3177619    "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_up.diff <- df_up.scaled %>% \n",
    "gather(protein, value, starts_with('prot'))  %>% \n",
    "spread(visit, value) %>%\n",
    "transmute(patient=pet, \n",
    "          protein=str_extract(protein, '[^_]+$'), \n",
    "          protein.change=`2`-`1`)\n",
    "head(df_up.diff)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>site</th><th scope=col>patient</th><th scope=col>protein</th><th scope=col>protein.change</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>A          </td><td> 0.07755833</td></tr>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>B          </td><td>-0.60571547</td></tr>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>C          </td><td> 2.26166848</td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>A          </td><td> 2.80037479</td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>B          </td><td> 0.64111624</td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>C          </td><td> 0.95898869</td></tr>\n",
       "\t<tr><td>duke       </td><td>Charlie    </td><td>A          </td><td> 0.83316369</td></tr>\n",
       "\t<tr><td>duke       </td><td>Charlie    </td><td>B          </td><td> 2.07089865</td></tr>\n",
       "\t<tr><td>duke       </td><td>Charlie    </td><td>C          </td><td> 0.35482775</td></tr>\n",
       "\t<tr><td>unc        </td><td>David      </td><td>A          </td><td>-1.49156020</td></tr>\n",
       "\t<tr><td>unc        </td><td>David      </td><td>B          </td><td>-0.86647868</td></tr>\n",
       "\t<tr><td>unc        </td><td>David      </td><td>C          </td><td> 1.60434377</td></tr>\n",
       "\t<tr><td>unc        </td><td>Ed         </td><td>A          </td><td> 1.68743457</td></tr>\n",
       "\t<tr><td>unc        </td><td>Ed         </td><td>B          </td><td> 1.61993404</td></tr>\n",
       "\t<tr><td>unc        </td><td>Ed         </td><td>C          </td><td>-0.31776193</td></tr>\n",
       "\t<tr><td>unc        </td><td>Fiona      </td><td>A          </td><td> 0.91584977</td></tr>\n",
       "\t<tr><td>unc        </td><td>Fiona      </td><td>B          </td><td>-0.15046013</td></tr>\n",
       "\t<tr><td>unc        </td><td>Fiona      </td><td>C          </td><td> 1.05110029</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|llll}\n",
       " site & patient & protein & protein.change\\\\\n",
       "\\hline\n",
       "\t duke        & Ann         & A           &  0.07755833\\\\\n",
       "\t duke        & Ann         & B           & -0.60571547\\\\\n",
       "\t duke        & Ann         & C           &  2.26166848\\\\\n",
       "\t duke        & Bob         & A           &  2.80037479\\\\\n",
       "\t duke        & Bob         & B           &  0.64111624\\\\\n",
       "\t duke        & Bob         & C           &  0.95898869\\\\\n",
       "\t duke        & Charlie     & A           &  0.83316369\\\\\n",
       "\t duke        & Charlie     & B           &  2.07089865\\\\\n",
       "\t duke        & Charlie     & C           &  0.35482775\\\\\n",
       "\t unc         & David       & A           & -1.49156020\\\\\n",
       "\t unc         & David       & B           & -0.86647868\\\\\n",
       "\t unc         & David       & C           &  1.60434377\\\\\n",
       "\t unc         & Ed          & A           &  1.68743457\\\\\n",
       "\t unc         & Ed          & B           &  1.61993404\\\\\n",
       "\t unc         & Ed          & C           & -0.31776193\\\\\n",
       "\t unc         & Fiona       & A           &  0.91584977\\\\\n",
       "\t unc         & Fiona       & B           & -0.15046013\\\\\n",
       "\t unc         & Fiona       & C           &  1.05110029\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "site | patient | protein | protein.change | \n",
       "|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n",
       "| duke        | Ann         | A           |  0.07755833 | \n",
       "| duke        | Ann         | B           | -0.60571547 | \n",
       "| duke        | Ann         | C           |  2.26166848 | \n",
       "| duke        | Bob         | A           |  2.80037479 | \n",
       "| duke        | Bob         | B           |  0.64111624 | \n",
       "| duke        | Bob         | C           |  0.95898869 | \n",
       "| duke        | Charlie     | A           |  0.83316369 | \n",
       "| duke        | Charlie     | B           |  2.07089865 | \n",
       "| duke        | Charlie     | C           |  0.35482775 | \n",
       "| unc         | David       | A           | -1.49156020 | \n",
       "| unc         | David       | B           | -0.86647868 | \n",
       "| unc         | David       | C           |  1.60434377 | \n",
       "| unc         | Ed          | A           |  1.68743457 | \n",
       "| unc         | Ed          | B           |  1.61993404 | \n",
       "| unc         | Ed          | C           | -0.31776193 | \n",
       "| unc         | Fiona       | A           |  0.91584977 | \n",
       "| unc         | Fiona       | B           | -0.15046013 | \n",
       "| unc         | Fiona       | C           |  1.05110029 | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "   site patient protein protein.change\n",
       "1  duke Ann     A        0.07755833   \n",
       "2  duke Ann     B       -0.60571547   \n",
       "3  duke Ann     C        2.26166848   \n",
       "4  duke Bob     A        2.80037479   \n",
       "5  duke Bob     B        0.64111624   \n",
       "6  duke Bob     C        0.95898869   \n",
       "7  duke Charlie A        0.83316369   \n",
       "8  duke Charlie B        2.07089865   \n",
       "9  duke Charlie C        0.35482775   \n",
       "10 unc  David   A       -1.49156020   \n",
       "11 unc  David   B       -0.86647868   \n",
       "12 unc  David   C        1.60434377   \n",
       "13 unc  Ed      A        1.68743457   \n",
       "14 unc  Ed      B        1.61993404   \n",
       "15 unc  Ed      C       -0.31776193   \n",
       "16 unc  Fiona   A        0.91584977   \n",
       "17 unc  Fiona   B       -0.15046013   \n",
       "18 unc  Fiona   C        1.05110029   "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_p <- bind_rows(list(duke=df_dp.diff, unc=df_up.diff), .id='site')\n",
    "df_p"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Combine gene and protein data into single data frame\n",
    "\n",
    "Sinec the rows are perfectly aligned, we can just bind columsn togehter. If we are not certain that the rows match up exactly, it is safer to use a `join` to combine columns."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>site</th><th scope=col>patient</th><th scope=col>gene</th><th scope=col>gene.change</th><th scope=col>site1</th><th scope=col>patient1</th><th scope=col>protein</th><th scope=col>protein.change</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>A          </td><td> 1.7391560 </td><td>duke       </td><td>Ann        </td><td>A          </td><td> 0.07755833</td></tr>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>B          </td><td> 1.7170389 </td><td>duke       </td><td>Ann        </td><td>B          </td><td>-0.60571547</td></tr>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>C          </td><td> 1.1929272 </td><td>duke       </td><td>Ann        </td><td>C          </td><td> 2.26166848</td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>A          </td><td> 2.4370022 </td><td>duke       </td><td>Bob        </td><td>A          </td><td> 2.80037479</td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>B          </td><td> 1.5513112 </td><td>duke       </td><td>Bob        </td><td>B          </td><td> 0.64111624</td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>C          </td><td> 2.8377604 </td><td>duke       </td><td>Bob        </td><td>C          </td><td> 0.95898869</td></tr>\n",
       "\t<tr><td>duke       </td><td>Charlie    </td><td>A          </td><td>-0.9307330 </td><td>duke       </td><td>Charlie    </td><td>A          </td><td> 0.83316369</td></tr>\n",
       "\t<tr><td>duke       </td><td>Charlie    </td><td>B          </td><td> 1.8112820 </td><td>duke       </td><td>Charlie    </td><td>B          </td><td> 2.07089865</td></tr>\n",
       "\t<tr><td>duke       </td><td>Charlie    </td><td>C          </td><td> 0.6021148 </td><td>duke       </td><td>Charlie    </td><td>C          </td><td> 0.35482775</td></tr>\n",
       "\t<tr><td>unc        </td><td>David      </td><td>A          </td><td> 0.6780785 </td><td>unc        </td><td>David      </td><td>A          </td><td>-1.49156020</td></tr>\n",
       "\t<tr><td>unc        </td><td>David      </td><td>B          </td><td> 1.7998124 </td><td>unc        </td><td>David      </td><td>B          </td><td>-0.86647868</td></tr>\n",
       "\t<tr><td>unc        </td><td>David      </td><td>C          </td><td> 0.9776623 </td><td>unc        </td><td>David      </td><td>C          </td><td> 1.60434377</td></tr>\n",
       "\t<tr><td>unc        </td><td>Ed         </td><td>A          </td><td> 0.7759811 </td><td>unc        </td><td>Ed         </td><td>A          </td><td> 1.68743457</td></tr>\n",
       "\t<tr><td>unc        </td><td>Ed         </td><td>B          </td><td> 0.3269814 </td><td>unc        </td><td>Ed         </td><td>B          </td><td> 1.61993404</td></tr>\n",
       "\t<tr><td>unc        </td><td>Ed         </td><td>C          </td><td> 0.8973218 </td><td>unc        </td><td>Ed         </td><td>C          </td><td>-0.31776193</td></tr>\n",
       "\t<tr><td>unc        </td><td>Fiona      </td><td>A          </td><td> 1.3541798 </td><td>unc        </td><td>Fiona      </td><td>A          </td><td> 0.91584977</td></tr>\n",
       "\t<tr><td>unc        </td><td>Fiona      </td><td>B          </td><td> 1.9866301 </td><td>unc        </td><td>Fiona      </td><td>B          </td><td>-0.15046013</td></tr>\n",
       "\t<tr><td>unc        </td><td>Fiona      </td><td>C          </td><td> 2.3377464 </td><td>unc        </td><td>Fiona      </td><td>C          </td><td> 1.05110029</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|llllllll}\n",
       " site & patient & gene & gene.change & site1 & patient1 & protein & protein.change\\\\\n",
       "\\hline\n",
       "\t duke        & Ann         & A           &  1.7391560  & duke        & Ann         & A           &  0.07755833\\\\\n",
       "\t duke        & Ann         & B           &  1.7170389  & duke        & Ann         & B           & -0.60571547\\\\\n",
       "\t duke        & Ann         & C           &  1.1929272  & duke        & Ann         & C           &  2.26166848\\\\\n",
       "\t duke        & Bob         & A           &  2.4370022  & duke        & Bob         & A           &  2.80037479\\\\\n",
       "\t duke        & Bob         & B           &  1.5513112  & duke        & Bob         & B           &  0.64111624\\\\\n",
       "\t duke        & Bob         & C           &  2.8377604  & duke        & Bob         & C           &  0.95898869\\\\\n",
       "\t duke        & Charlie     & A           & -0.9307330  & duke        & Charlie     & A           &  0.83316369\\\\\n",
       "\t duke        & Charlie     & B           &  1.8112820  & duke        & Charlie     & B           &  2.07089865\\\\\n",
       "\t duke        & Charlie     & C           &  0.6021148  & duke        & Charlie     & C           &  0.35482775\\\\\n",
       "\t unc         & David       & A           &  0.6780785  & unc         & David       & A           & -1.49156020\\\\\n",
       "\t unc         & David       & B           &  1.7998124  & unc         & David       & B           & -0.86647868\\\\\n",
       "\t unc         & David       & C           &  0.9776623  & unc         & David       & C           &  1.60434377\\\\\n",
       "\t unc         & Ed          & A           &  0.7759811  & unc         & Ed          & A           &  1.68743457\\\\\n",
       "\t unc         & Ed          & B           &  0.3269814  & unc         & Ed          & B           &  1.61993404\\\\\n",
       "\t unc         & Ed          & C           &  0.8973218  & unc         & Ed          & C           & -0.31776193\\\\\n",
       "\t unc         & Fiona       & A           &  1.3541798  & unc         & Fiona       & A           &  0.91584977\\\\\n",
       "\t unc         & Fiona       & B           &  1.9866301  & unc         & Fiona       & B           & -0.15046013\\\\\n",
       "\t unc         & Fiona       & C           &  2.3377464  & unc         & Fiona       & C           &  1.05110029\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "site | patient | gene | gene.change | site1 | patient1 | protein | protein.change | \n",
       "|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n",
       "| duke        | Ann         | A           |  1.7391560  | duke        | Ann         | A           |  0.07755833 | \n",
       "| duke        | Ann         | B           |  1.7170389  | duke        | Ann         | B           | -0.60571547 | \n",
       "| duke        | Ann         | C           |  1.1929272  | duke        | Ann         | C           |  2.26166848 | \n",
       "| duke        | Bob         | A           |  2.4370022  | duke        | Bob         | A           |  2.80037479 | \n",
       "| duke        | Bob         | B           |  1.5513112  | duke        | Bob         | B           |  0.64111624 | \n",
       "| duke        | Bob         | C           |  2.8377604  | duke        | Bob         | C           |  0.95898869 | \n",
       "| duke        | Charlie     | A           | -0.9307330  | duke        | Charlie     | A           |  0.83316369 | \n",
       "| duke        | Charlie     | B           |  1.8112820  | duke        | Charlie     | B           |  2.07089865 | \n",
       "| duke        | Charlie     | C           |  0.6021148  | duke        | Charlie     | C           |  0.35482775 | \n",
       "| unc         | David       | A           |  0.6780785  | unc         | David       | A           | -1.49156020 | \n",
       "| unc         | David       | B           |  1.7998124  | unc         | David       | B           | -0.86647868 | \n",
       "| unc         | David       | C           |  0.9776623  | unc         | David       | C           |  1.60434377 | \n",
       "| unc         | Ed          | A           |  0.7759811  | unc         | Ed          | A           |  1.68743457 | \n",
       "| unc         | Ed          | B           |  0.3269814  | unc         | Ed          | B           |  1.61993404 | \n",
       "| unc         | Ed          | C           |  0.8973218  | unc         | Ed          | C           | -0.31776193 | \n",
       "| unc         | Fiona       | A           |  1.3541798  | unc         | Fiona       | A           |  0.91584977 | \n",
       "| unc         | Fiona       | B           |  1.9866301  | unc         | Fiona       | B           | -0.15046013 | \n",
       "| unc         | Fiona       | C           |  2.3377464  | unc         | Fiona       | C           |  1.05110029 | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "   site patient gene gene.change site1 patient1 protein protein.change\n",
       "1  duke Ann     A     1.7391560  duke  Ann      A        0.07755833   \n",
       "2  duke Ann     B     1.7170389  duke  Ann      B       -0.60571547   \n",
       "3  duke Ann     C     1.1929272  duke  Ann      C        2.26166848   \n",
       "4  duke Bob     A     2.4370022  duke  Bob      A        2.80037479   \n",
       "5  duke Bob     B     1.5513112  duke  Bob      B        0.64111624   \n",
       "6  duke Bob     C     2.8377604  duke  Bob      C        0.95898869   \n",
       "7  duke Charlie A    -0.9307330  duke  Charlie  A        0.83316369   \n",
       "8  duke Charlie B     1.8112820  duke  Charlie  B        2.07089865   \n",
       "9  duke Charlie C     0.6021148  duke  Charlie  C        0.35482775   \n",
       "10 unc  David   A     0.6780785  unc   David    A       -1.49156020   \n",
       "11 unc  David   B     1.7998124  unc   David    B       -0.86647868   \n",
       "12 unc  David   C     0.9776623  unc   David    C        1.60434377   \n",
       "13 unc  Ed      A     0.7759811  unc   Ed       A        1.68743457   \n",
       "14 unc  Ed      B     0.3269814  unc   Ed       B        1.61993404   \n",
       "15 unc  Ed      C     0.8973218  unc   Ed       C       -0.31776193   \n",
       "16 unc  Fiona   A     1.3541798  unc   Fiona    A        0.91584977   \n",
       "17 unc  Fiona   B     1.9866301  unc   Fiona    B       -0.15046013   \n",
       "18 unc  Fiona   C     2.3377464  unc   Fiona    C        1.05110029   "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "bind_cols(df_g, df_p, )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 118,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>site</th><th scope=col>patient</th><th scope=col>gene</th><th scope=col>gene.change</th><th scope=col>protein.change</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>A          </td><td>1.739156   </td><td> 0.07755833</td></tr>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>B          </td><td>1.717039   </td><td>-0.60571547</td></tr>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>C          </td><td>1.192927   </td><td> 2.26166848</td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>A          </td><td>2.437002   </td><td> 2.80037479</td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>B          </td><td>1.551311   </td><td> 0.64111624</td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>C          </td><td>2.837760   </td><td> 0.95898869</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lllll}\n",
       " site & patient & gene & gene.change & protein.change\\\\\n",
       "\\hline\n",
       "\t duke        & Ann         & A           & 1.739156    &  0.07755833\\\\\n",
       "\t duke        & Ann         & B           & 1.717039    & -0.60571547\\\\\n",
       "\t duke        & Ann         & C           & 1.192927    &  2.26166848\\\\\n",
       "\t duke        & Bob         & A           & 2.437002    &  2.80037479\\\\\n",
       "\t duke        & Bob         & B           & 1.551311    &  0.64111624\\\\\n",
       "\t duke        & Bob         & C           & 2.837760    &  0.95898869\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "site | patient | gene | gene.change | protein.change | \n",
       "|---|---|---|---|---|---|\n",
       "| duke        | Ann         | A           | 1.739156    |  0.07755833 | \n",
       "| duke        | Ann         | B           | 1.717039    | -0.60571547 | \n",
       "| duke        | Ann         | C           | 1.192927    |  2.26166848 | \n",
       "| duke        | Bob         | A           | 2.437002    |  2.80037479 | \n",
       "| duke        | Bob         | B           | 1.551311    |  0.64111624 | \n",
       "| duke        | Bob         | C           | 2.837760    |  0.95898869 | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  site patient gene gene.change protein.change\n",
       "1 duke Ann     A    1.739156     0.07755833   \n",
       "2 duke Ann     B    1.717039    -0.60571547   \n",
       "3 duke Ann     C    1.192927     2.26166848   \n",
       "4 duke Bob     A    2.437002     2.80037479   \n",
       "5 duke Bob     B    1.551311     0.64111624   \n",
       "6 duke Bob     C    2.837760     0.95898869   "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_gp <- bind_cols(df_g, df_p %>% select(-site, -patient, -protein))\n",
    "head(df_gp)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Combine with demographic data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Parsed with column specification:\n",
      "cols(\n",
      "  patients = col_character(),\n",
      "  age = col_integer(),\n",
      "  sex = col_character()\n",
      ")\n",
      "Parsed with column specification:\n",
      "cols(\n",
      "  patients = col_character(),\n",
      "  age = col_integer(),\n",
      "  sex = col_character()\n",
      ")\n"
     ]
    }
   ],
   "source": [
    "df_dd <- read_tsv('data/duke_demographics.tsv')\n",
    "df_ud <- read_tsv('data/unc_demographics.tsv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>patients</th><th scope=col>age</th><th scope=col>sex</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>Ann    </td><td>16     </td><td>F      </td></tr>\n",
       "\t<tr><td>Bob    </td><td>23     </td><td>M      </td></tr>\n",
       "\t<tr><td>Beth   </td><td>43     </td><td>F      </td></tr>\n",
       "\t<tr><td>Charlie</td><td>53     </td><td>M      </td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lll}\n",
       " patients & age & sex\\\\\n",
       "\\hline\n",
       "\t Ann     & 16      & F      \\\\\n",
       "\t Bob     & 23      & M      \\\\\n",
       "\t Beth    & 43      & F      \\\\\n",
       "\t Charlie & 53      & M      \\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "patients | age | sex | \n",
       "|---|---|---|---|\n",
       "| Ann     | 16      | F       | \n",
       "| Bob     | 23      | M       | \n",
       "| Beth    | 43      | F       | \n",
       "| Charlie | 53      | M       | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  patients age sex\n",
       "1 Ann      16  F  \n",
       "2 Bob      23  M  \n",
       "3 Beth     43  F  \n",
       "4 Charlie  53  M  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "head(df_dd)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>patients</th><th scope=col>age</th><th scope=col>sex</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>David </td><td>49    </td><td>K     </td></tr>\n",
       "\t<tr><td>Edward</td><td>53    </td><td>M     </td></tr>\n",
       "\t<tr><td>Fiona </td><td>67    </td><td>F     </td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lll}\n",
       " patients & age & sex\\\\\n",
       "\\hline\n",
       "\t David  & 49     & K     \\\\\n",
       "\t Edward & 53     & M     \\\\\n",
       "\t Fiona  & 67     & F     \\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "patients | age | sex | \n",
       "|---|---|---|\n",
       "| David  | 49     | K      | \n",
       "| Edward | 53     | M      | \n",
       "| Fiona  | 67     | F      | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  patients age sex\n",
       "1 David    49  K  \n",
       "2 Edward   53  M  \n",
       "3 Fiona    67  F  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "head(df_ud)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 139,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>site</th><th scope=col>patients</th><th scope=col>age</th><th scope=col>sex</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>duke   </td><td>Ann    </td><td>16     </td><td>F      </td></tr>\n",
       "\t<tr><td>duke   </td><td>Bob    </td><td>23     </td><td>M      </td></tr>\n",
       "\t<tr><td>duke   </td><td>Beth   </td><td>43     </td><td>F      </td></tr>\n",
       "\t<tr><td>duke   </td><td>Charlie</td><td>53     </td><td>M      </td></tr>\n",
       "\t<tr><td>unc    </td><td>David  </td><td>49     </td><td>K      </td></tr>\n",
       "\t<tr><td>unc    </td><td>Edward </td><td>53     </td><td>M      </td></tr>\n",
       "\t<tr><td>unc    </td><td>Fiona  </td><td>67     </td><td>F      </td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|llll}\n",
       " site & patients & age & sex\\\\\n",
       "\\hline\n",
       "\t duke    & Ann     & 16      & F      \\\\\n",
       "\t duke    & Bob     & 23      & M      \\\\\n",
       "\t duke    & Beth    & 43      & F      \\\\\n",
       "\t duke    & Charlie & 53      & M      \\\\\n",
       "\t unc     & David   & 49      & K      \\\\\n",
       "\t unc     & Edward  & 53      & M      \\\\\n",
       "\t unc     & Fiona   & 67      & F      \\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "site | patients | age | sex | \n",
       "|---|---|---|---|---|---|---|\n",
       "| duke    | Ann     | 16      | F       | \n",
       "| duke    | Bob     | 23      | M       | \n",
       "| duke    | Beth    | 43      | F       | \n",
       "| duke    | Charlie | 53      | M       | \n",
       "| unc     | David   | 49      | K       | \n",
       "| unc     | Edward  | 53      | M       | \n",
       "| unc     | Fiona   | 67      | F       | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  site patients age sex\n",
       "1 duke Ann      16  F  \n",
       "2 duke Bob      23  M  \n",
       "3 duke Beth     43  F  \n",
       "4 duke Charlie  53  M  \n",
       "5 unc  David    49  K  \n",
       "6 unc  Edward   53  M  \n",
       "7 unc  Fiona    67  F  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_d <- bind_rows(list(duke=df_dd, unc=df_ud), .id='site')\n",
    "df_d"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 140,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>site</th><th scope=col>patient</th><th scope=col>gene</th><th scope=col>gene.change</th><th scope=col>protein.change</th><th scope=col>age</th><th scope=col>sex</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>A          </td><td> 1.7391560 </td><td> 0.07755833</td><td>16         </td><td>F          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>B          </td><td> 1.7170389 </td><td>-0.60571547</td><td>16         </td><td>F          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>C          </td><td> 1.1929272 </td><td> 2.26166848</td><td>16         </td><td>F          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>A          </td><td> 2.4370022 </td><td> 2.80037479</td><td>23         </td><td>M          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>B          </td><td> 1.5513112 </td><td> 0.64111624</td><td>23         </td><td>M          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>C          </td><td> 2.8377604 </td><td> 0.95898869</td><td>23         </td><td>M          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Charlie    </td><td>A          </td><td>-0.9307330 </td><td> 0.83316369</td><td>53         </td><td>M          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Charlie    </td><td>B          </td><td> 1.8112820 </td><td> 2.07089865</td><td>53         </td><td>M          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Charlie    </td><td>C          </td><td> 0.6021148 </td><td> 0.35482775</td><td>53         </td><td>M          </td></tr>\n",
       "\t<tr><td>unc        </td><td>David      </td><td>A          </td><td> 0.6780785 </td><td>-1.49156020</td><td>49         </td><td>K          </td></tr>\n",
       "\t<tr><td>unc        </td><td>David      </td><td>B          </td><td> 1.7998124 </td><td>-0.86647868</td><td>49         </td><td>K          </td></tr>\n",
       "\t<tr><td>unc        </td><td>David      </td><td>C          </td><td> 0.9776623 </td><td> 1.60434377</td><td>49         </td><td>K          </td></tr>\n",
       "\t<tr><td>unc        </td><td>Ed         </td><td>A          </td><td> 0.7759811 </td><td> 1.68743457</td><td>NA         </td><td>NA         </td></tr>\n",
       "\t<tr><td>unc        </td><td>Ed         </td><td>B          </td><td> 0.3269814 </td><td> 1.61993404</td><td>NA         </td><td>NA         </td></tr>\n",
       "\t<tr><td>unc        </td><td>Ed         </td><td>C          </td><td> 0.8973218 </td><td>-0.31776193</td><td>NA         </td><td>NA         </td></tr>\n",
       "\t<tr><td>unc        </td><td>Fiona      </td><td>A          </td><td> 1.3541798 </td><td> 0.91584977</td><td>67         </td><td>F          </td></tr>\n",
       "\t<tr><td>unc        </td><td>Fiona      </td><td>B          </td><td> 1.9866301 </td><td>-0.15046013</td><td>67         </td><td>F          </td></tr>\n",
       "\t<tr><td>unc        </td><td>Fiona      </td><td>C          </td><td> 2.3377464 </td><td> 1.05110029</td><td>67         </td><td>F          </td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lllllll}\n",
       " site & patient & gene & gene.change & protein.change & age & sex\\\\\n",
       "\\hline\n",
       "\t duke        & Ann         & A           &  1.7391560  &  0.07755833 & 16          & F          \\\\\n",
       "\t duke        & Ann         & B           &  1.7170389  & -0.60571547 & 16          & F          \\\\\n",
       "\t duke        & Ann         & C           &  1.1929272  &  2.26166848 & 16          & F          \\\\\n",
       "\t duke        & Bob         & A           &  2.4370022  &  2.80037479 & 23          & M          \\\\\n",
       "\t duke        & Bob         & B           &  1.5513112  &  0.64111624 & 23          & M          \\\\\n",
       "\t duke        & Bob         & C           &  2.8377604  &  0.95898869 & 23          & M          \\\\\n",
       "\t duke        & Charlie     & A           & -0.9307330  &  0.83316369 & 53          & M          \\\\\n",
       "\t duke        & Charlie     & B           &  1.8112820  &  2.07089865 & 53          & M          \\\\\n",
       "\t duke        & Charlie     & C           &  0.6021148  &  0.35482775 & 53          & M          \\\\\n",
       "\t unc         & David       & A           &  0.6780785  & -1.49156020 & 49          & K          \\\\\n",
       "\t unc         & David       & B           &  1.7998124  & -0.86647868 & 49          & K          \\\\\n",
       "\t unc         & David       & C           &  0.9776623  &  1.60434377 & 49          & K          \\\\\n",
       "\t unc         & Ed          & A           &  0.7759811  &  1.68743457 & NA          & NA         \\\\\n",
       "\t unc         & Ed          & B           &  0.3269814  &  1.61993404 & NA          & NA         \\\\\n",
       "\t unc         & Ed          & C           &  0.8973218  & -0.31776193 & NA          & NA         \\\\\n",
       "\t unc         & Fiona       & A           &  1.3541798  &  0.91584977 & 67          & F          \\\\\n",
       "\t unc         & Fiona       & B           &  1.9866301  & -0.15046013 & 67          & F          \\\\\n",
       "\t unc         & Fiona       & C           &  2.3377464  &  1.05110029 & 67          & F          \\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "site | patient | gene | gene.change | protein.change | age | sex | \n",
       "|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n",
       "| duke        | Ann         | A           |  1.7391560  |  0.07755833 | 16          | F           | \n",
       "| duke        | Ann         | B           |  1.7170389  | -0.60571547 | 16          | F           | \n",
       "| duke        | Ann         | C           |  1.1929272  |  2.26166848 | 16          | F           | \n",
       "| duke        | Bob         | A           |  2.4370022  |  2.80037479 | 23          | M           | \n",
       "| duke        | Bob         | B           |  1.5513112  |  0.64111624 | 23          | M           | \n",
       "| duke        | Bob         | C           |  2.8377604  |  0.95898869 | 23          | M           | \n",
       "| duke        | Charlie     | A           | -0.9307330  |  0.83316369 | 53          | M           | \n",
       "| duke        | Charlie     | B           |  1.8112820  |  2.07089865 | 53          | M           | \n",
       "| duke        | Charlie     | C           |  0.6021148  |  0.35482775 | 53          | M           | \n",
       "| unc         | David       | A           |  0.6780785  | -1.49156020 | 49          | K           | \n",
       "| unc         | David       | B           |  1.7998124  | -0.86647868 | 49          | K           | \n",
       "| unc         | David       | C           |  0.9776623  |  1.60434377 | 49          | K           | \n",
       "| unc         | Ed          | A           |  0.7759811  |  1.68743457 | NA          | NA          | \n",
       "| unc         | Ed          | B           |  0.3269814  |  1.61993404 | NA          | NA          | \n",
       "| unc         | Ed          | C           |  0.8973218  | -0.31776193 | NA          | NA          | \n",
       "| unc         | Fiona       | A           |  1.3541798  |  0.91584977 | 67          | F           | \n",
       "| unc         | Fiona       | B           |  1.9866301  | -0.15046013 | 67          | F           | \n",
       "| unc         | Fiona       | C           |  2.3377464  |  1.05110029 | 67          | F           | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "   site patient gene gene.change protein.change age sex\n",
       "1  duke Ann     A     1.7391560   0.07755833    16  F  \n",
       "2  duke Ann     B     1.7170389  -0.60571547    16  F  \n",
       "3  duke Ann     C     1.1929272   2.26166848    16  F  \n",
       "4  duke Bob     A     2.4370022   2.80037479    23  M  \n",
       "5  duke Bob     B     1.5513112   0.64111624    23  M  \n",
       "6  duke Bob     C     2.8377604   0.95898869    23  M  \n",
       "7  duke Charlie A    -0.9307330   0.83316369    53  M  \n",
       "8  duke Charlie B     1.8112820   2.07089865    53  M  \n",
       "9  duke Charlie C     0.6021148   0.35482775    53  M  \n",
       "10 unc  David   A     0.6780785  -1.49156020    49  K  \n",
       "11 unc  David   B     1.7998124  -0.86647868    49  K  \n",
       "12 unc  David   C     0.9776623   1.60434377    49  K  \n",
       "13 unc  Ed      A     0.7759811   1.68743457    NA  NA \n",
       "14 unc  Ed      B     0.3269814   1.61993404    NA  NA \n",
       "15 unc  Ed      C     0.8973218  -0.31776193    NA  NA \n",
       "16 unc  Fiona   A     1.3541798   0.91584977    67  F  \n",
       "17 unc  Fiona   B     1.9866301  -0.15046013    67  F  \n",
       "18 unc  Fiona   C     2.3377464   1.05110029    67  F  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "left_join(df_gp, df_d, by = c('site', c('patient'='patients')))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "There are missing values for Ed because the neames don't match. We know that Ed's name in this case is really Edward, so we fix and try again."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 147,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>site</th><th scope=col>patient</th><th scope=col>gene</th><th scope=col>gene.change</th><th scope=col>protein.change</th><th scope=col>age</th><th scope=col>sex</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>A          </td><td> 1.7391560 </td><td> 0.07755833</td><td>16         </td><td>F          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>B          </td><td> 1.7170389 </td><td>-0.60571547</td><td>16         </td><td>F          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>C          </td><td> 1.1929272 </td><td> 2.26166848</td><td>16         </td><td>F          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>A          </td><td> 2.4370022 </td><td> 2.80037479</td><td>23         </td><td>M          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>B          </td><td> 1.5513112 </td><td> 0.64111624</td><td>23         </td><td>M          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>C          </td><td> 2.8377604 </td><td> 0.95898869</td><td>23         </td><td>M          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Charlie    </td><td>A          </td><td>-0.9307330 </td><td> 0.83316369</td><td>53         </td><td>M          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Charlie    </td><td>B          </td><td> 1.8112820 </td><td> 2.07089865</td><td>53         </td><td>M          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Charlie    </td><td>C          </td><td> 0.6021148 </td><td> 0.35482775</td><td>53         </td><td>M          </td></tr>\n",
       "\t<tr><td>unc        </td><td>David      </td><td>A          </td><td> 0.6780785 </td><td>-1.49156020</td><td>49         </td><td>K          </td></tr>\n",
       "\t<tr><td>unc        </td><td>David      </td><td>B          </td><td> 1.7998124 </td><td>-0.86647868</td><td>49         </td><td>K          </td></tr>\n",
       "\t<tr><td>unc        </td><td>David      </td><td>C          </td><td> 0.9776623 </td><td> 1.60434377</td><td>49         </td><td>K          </td></tr>\n",
       "\t<tr><td>unc        </td><td>Edward     </td><td>A          </td><td> 0.7759811 </td><td> 1.68743457</td><td>53         </td><td>M          </td></tr>\n",
       "\t<tr><td>unc        </td><td>Edward     </td><td>B          </td><td> 0.3269814 </td><td> 1.61993404</td><td>53         </td><td>M          </td></tr>\n",
       "\t<tr><td>unc        </td><td>Edward     </td><td>C          </td><td> 0.8973218 </td><td>-0.31776193</td><td>53         </td><td>M          </td></tr>\n",
       "\t<tr><td>unc        </td><td>Fiona      </td><td>A          </td><td> 1.3541798 </td><td> 0.91584977</td><td>67         </td><td>F          </td></tr>\n",
       "\t<tr><td>unc        </td><td>Fiona      </td><td>B          </td><td> 1.9866301 </td><td>-0.15046013</td><td>67         </td><td>F          </td></tr>\n",
       "\t<tr><td>unc        </td><td>Fiona      </td><td>C          </td><td> 2.3377464 </td><td> 1.05110029</td><td>67         </td><td>F          </td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lllllll}\n",
       " site & patient & gene & gene.change & protein.change & age & sex\\\\\n",
       "\\hline\n",
       "\t duke        & Ann         & A           &  1.7391560  &  0.07755833 & 16          & F          \\\\\n",
       "\t duke        & Ann         & B           &  1.7170389  & -0.60571547 & 16          & F          \\\\\n",
       "\t duke        & Ann         & C           &  1.1929272  &  2.26166848 & 16          & F          \\\\\n",
       "\t duke        & Bob         & A           &  2.4370022  &  2.80037479 & 23          & M          \\\\\n",
       "\t duke        & Bob         & B           &  1.5513112  &  0.64111624 & 23          & M          \\\\\n",
       "\t duke        & Bob         & C           &  2.8377604  &  0.95898869 & 23          & M          \\\\\n",
       "\t duke        & Charlie     & A           & -0.9307330  &  0.83316369 & 53          & M          \\\\\n",
       "\t duke        & Charlie     & B           &  1.8112820  &  2.07089865 & 53          & M          \\\\\n",
       "\t duke        & Charlie     & C           &  0.6021148  &  0.35482775 & 53          & M          \\\\\n",
       "\t unc         & David       & A           &  0.6780785  & -1.49156020 & 49          & K          \\\\\n",
       "\t unc         & David       & B           &  1.7998124  & -0.86647868 & 49          & K          \\\\\n",
       "\t unc         & David       & C           &  0.9776623  &  1.60434377 & 49          & K          \\\\\n",
       "\t unc         & Edward      & A           &  0.7759811  &  1.68743457 & 53          & M          \\\\\n",
       "\t unc         & Edward      & B           &  0.3269814  &  1.61993404 & 53          & M          \\\\\n",
       "\t unc         & Edward      & C           &  0.8973218  & -0.31776193 & 53          & M          \\\\\n",
       "\t unc         & Fiona       & A           &  1.3541798  &  0.91584977 & 67          & F          \\\\\n",
       "\t unc         & Fiona       & B           &  1.9866301  & -0.15046013 & 67          & F          \\\\\n",
       "\t unc         & Fiona       & C           &  2.3377464  &  1.05110029 & 67          & F          \\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "site | patient | gene | gene.change | protein.change | age | sex | \n",
       "|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n",
       "| duke        | Ann         | A           |  1.7391560  |  0.07755833 | 16          | F           | \n",
       "| duke        | Ann         | B           |  1.7170389  | -0.60571547 | 16          | F           | \n",
       "| duke        | Ann         | C           |  1.1929272  |  2.26166848 | 16          | F           | \n",
       "| duke        | Bob         | A           |  2.4370022  |  2.80037479 | 23          | M           | \n",
       "| duke        | Bob         | B           |  1.5513112  |  0.64111624 | 23          | M           | \n",
       "| duke        | Bob         | C           |  2.8377604  |  0.95898869 | 23          | M           | \n",
       "| duke        | Charlie     | A           | -0.9307330  |  0.83316369 | 53          | M           | \n",
       "| duke        | Charlie     | B           |  1.8112820  |  2.07089865 | 53          | M           | \n",
       "| duke        | Charlie     | C           |  0.6021148  |  0.35482775 | 53          | M           | \n",
       "| unc         | David       | A           |  0.6780785  | -1.49156020 | 49          | K           | \n",
       "| unc         | David       | B           |  1.7998124  | -0.86647868 | 49          | K           | \n",
       "| unc         | David       | C           |  0.9776623  |  1.60434377 | 49          | K           | \n",
       "| unc         | Edward      | A           |  0.7759811  |  1.68743457 | 53          | M           | \n",
       "| unc         | Edward      | B           |  0.3269814  |  1.61993404 | 53          | M           | \n",
       "| unc         | Edward      | C           |  0.8973218  | -0.31776193 | 53          | M           | \n",
       "| unc         | Fiona       | A           |  1.3541798  |  0.91584977 | 67          | F           | \n",
       "| unc         | Fiona       | B           |  1.9866301  | -0.15046013 | 67          | F           | \n",
       "| unc         | Fiona       | C           |  2.3377464  |  1.05110029 | 67          | F           | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "   site patient gene gene.change protein.change age sex\n",
       "1  duke Ann     A     1.7391560   0.07755833    16  F  \n",
       "2  duke Ann     B     1.7170389  -0.60571547    16  F  \n",
       "3  duke Ann     C     1.1929272   2.26166848    16  F  \n",
       "4  duke Bob     A     2.4370022   2.80037479    23  M  \n",
       "5  duke Bob     B     1.5513112   0.64111624    23  M  \n",
       "6  duke Bob     C     2.8377604   0.95898869    23  M  \n",
       "7  duke Charlie A    -0.9307330   0.83316369    53  M  \n",
       "8  duke Charlie B     1.8112820   2.07089865    53  M  \n",
       "9  duke Charlie C     0.6021148   0.35482775    53  M  \n",
       "10 unc  David   A     0.6780785  -1.49156020    49  K  \n",
       "11 unc  David   B     1.7998124  -0.86647868    49  K  \n",
       "12 unc  David   C     0.9776623   1.60434377    49  K  \n",
       "13 unc  Edward  A     0.7759811   1.68743457    53  M  \n",
       "14 unc  Edward  B     0.3269814   1.61993404    53  M  \n",
       "15 unc  Edward  C     0.8973218  -0.31776193    53  M  \n",
       "16 unc  Fiona   A     1.3541798   0.91584977    67  F  \n",
       "17 unc  Fiona   B     1.9866301  -0.15046013    67  F  \n",
       "18 unc  Fiona   C     2.3377464   1.05110029    67  F  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "left_join(df_gp %>% mutate(patient=recode(patient, 'Ed'='Edward')),\n",
    "          df_d, \n",
    "          by = c('site', c('patient'='patients')))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 148,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_all <- left_join(df_gp %>% mutate(patient=recode(patient, 'Ed'='Edward')),\n",
    "          df_d, \n",
    "          by = c('site', c('patient'='patients')))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 150,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<thead><tr><th scope=col>site</th><th scope=col>patient</th><th scope=col>gene</th><th scope=col>gene.change</th><th scope=col>protein.change</th><th scope=col>age</th><th scope=col>sex</th></tr></thead>\n",
       "<tbody>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>A          </td><td>1.739156   </td><td> 0.07755833</td><td>16         </td><td>F          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>B          </td><td>1.717039   </td><td>-0.60571547</td><td>16         </td><td>F          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Ann        </td><td>C          </td><td>1.192927   </td><td> 2.26166848</td><td>16         </td><td>F          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>A          </td><td>2.437002   </td><td> 2.80037479</td><td>23         </td><td>M          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>B          </td><td>1.551311   </td><td> 0.64111624</td><td>23         </td><td>M          </td></tr>\n",
       "\t<tr><td>duke       </td><td>Bob        </td><td>C          </td><td>2.837760   </td><td> 0.95898869</td><td>23         </td><td>M          </td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "\\begin{tabular}{r|lllllll}\n",
       " site & patient & gene & gene.change & protein.change & age & sex\\\\\n",
       "\\hline\n",
       "\t duke        & Ann         & A           & 1.739156    &  0.07755833 & 16          & F          \\\\\n",
       "\t duke        & Ann         & B           & 1.717039    & -0.60571547 & 16          & F          \\\\\n",
       "\t duke        & Ann         & C           & 1.192927    &  2.26166848 & 16          & F          \\\\\n",
       "\t duke        & Bob         & A           & 2.437002    &  2.80037479 & 23          & M          \\\\\n",
       "\t duke        & Bob         & B           & 1.551311    &  0.64111624 & 23          & M          \\\\\n",
       "\t duke        & Bob         & C           & 2.837760    &  0.95898869 & 23          & M          \\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "site | patient | gene | gene.change | protein.change | age | sex | \n",
       "|---|---|---|---|---|---|\n",
       "| duke        | Ann         | A           | 1.739156    |  0.07755833 | 16          | F           | \n",
       "| duke        | Ann         | B           | 1.717039    | -0.60571547 | 16          | F           | \n",
       "| duke        | Ann         | C           | 1.192927    |  2.26166848 | 16          | F           | \n",
       "| duke        | Bob         | A           | 2.437002    |  2.80037479 | 23          | M           | \n",
       "| duke        | Bob         | B           | 1.551311    |  0.64111624 | 23          | M           | \n",
       "| duke        | Bob         | C           | 2.837760    |  0.95898869 | 23          | M           | \n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  site patient gene gene.change protein.change age sex\n",
       "1 duke Ann     A    1.739156     0.07755833    16  F  \n",
       "2 duke Ann     B    1.717039    -0.60571547    16  F  \n",
       "3 duke Ann     C    1.192927     2.26166848    16  F  \n",
       "4 duke Bob     A    2.437002     2.80037479    23  M  \n",
       "5 duke Bob     B    1.551311     0.64111624    23  M  \n",
       "6 duke Bob     C    2.837760     0.95898869    23  M  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "head(df_all)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 161,
   "metadata": {},
   "outputs": [],
   "source": [
    "options(repr.plot.width=8, repr.plot.height=3)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Plotting the data suggests that there may be an increase in most genes and proteins from visit 1 to visit 2 (since most of the changes are positive), but there is no obvious correlation between the gene and its protein product."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 171,
   "metadata": {},
   "outputs": [
    {
     "data": {},
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n+utz586NiYkpu/fYsWP33Xdf06ZN4+LievXqtX79+rK7Bg4ceOedd546dap///5Op7N+/foP\nP/xwfn5+KI+93I4dO/r375+UlJSWlnb//fcfP368/L3Hjh0bPHhwSkpK/fr1x48fn5eXV3bX\nW2+91bVr14SEhNjY2I4dOy5evDj0CK+67QCAsJAURdE7BgBQ5+23377//vvbtm07bNiws2fP\nLl26NDk5OS8vr6CgQAixZ8+enj17Op3OUaNG2Wy2d95554cffli0aNG4ceOEEAMHDszPzzca\njY899linTp02bNjw6KOPjh079o033qjysRW8//77d911V+vWre+66678/PzFixenpKTs3r07\nJiZm4MCBe/fulWV56NChmZmZGzZsWLt27fjx4xctWiSEWLt27V133dW1a9chQ4bk5ORs3Lhx\n3759a9asufvuu6uMsDptBwCEhwIANYrL5WrcuHHnzp1LSkoCJe+//74Qwul0BjZ79erVuHHj\nrKyswKbb7e7du3dMTExBQYGiKAMGDBBCbNq0qewJBwwY0Lhx41AeW57b7W7WrFlmZmZxcXGg\nZOPGjUKIJUuWlNXy+uuvB+7y+/2ZmZkZGRmBzTvvvLNhw4YulyuwWVpaGhsb+/DDD5fFc6UI\nq9l2AEBYMIUDQA3z1VdfnThxYsqUKVarNVAyePDga6+9NnA7Jydn27ZtDz/8cGJiYqDEZDL9\n5je/KSgo2LlzZ6AkMTGxT58+ZU+YlpZWXFwc4mPL7N69+8iRI4899pjNZguU9OvX709/+lPj\nxo0Dm06n86GHHgrcliQpkGoHNhctWrR3716z2RzYLCgo8Pl8ZfcGibD6bQcAVB8JNIAa5vDh\nw0KI6667rnxh2ebBgweFEDNnzpTKCUyNuHjxYmCfshw3QJKk0B8bJAxJkqZNm3brrbcGNps2\nbWowGMruleV/v94mJSVlZWWtWLHiySef7N27d8OGDYuKiso/+ZUirH7bAQDVZ9Q7AABQx+12\nX15YlqoGhnWfeuqpwESI8lq1ahW4YTRW/tIXymMrhHGlpxJClA0SX+7VV1998sknY2Jibrvt\nthEjRsyfP3/IkCHld7jS01a/7QCA6iOBBlDDtGjRQgjx008/tWvXrqwwMPgqhGjevLkQQpbl\nXr16ld179uzZQ4cOxcfHB39mVY8N7Hzo0KEbbrihrPCll15q1KjR8OHDg9RSVFQ0bdq0+++/\n/4033ijLfV0uV/DYAiLXdgBA6JjCAaCG6dq1a0pKyoIFC8qGYzdv3rx3797A7djY2FtvvfX1\n118vm7Tg9/vHjBkzfPhwk8kU/JlVPbZjx4716tV7+eWXy8LYs2fP7373u2PHjgWv5dixYy6X\n64YbbijLnj/66KMLFy74/X4d2w4ACB0j0ABqGKfTOXv27HHjxvXo0ePOO++8cOHC8uXLe/Xq\ntX///sAOL730Us+ePTMzM8eOHWswGD788MPvvvtuxYoV5WckX0nwx65cufLpp5+eMmXK5MmT\n7Xb7Sy+9NHr06O7du991110ul+tvf/tbw4YNJ06cGLyKli1bNmzY8IUXXrh48WJGRsbXX3/9\n7rvvNmzY8JNPPlm2bNmDDz6oV9sBACFiBBpAzfPQQw+98847BoNhzpw5e/bsWbt27Y033pia\nmhq4t0OHDrt27erWrdubb775yiuv2Gy2Dz74YOTIkVd6NoPBkJCQEMpji4qKTp06VbamyciR\nIz/66KPY2NiXXnrpjTfeuOWWWz7//POyK2BcidlsXr9+fZs2bRYsWPD73/8+Jydn586da9as\nufbaa7/44osqIwxv2wEAV4GFVADUMD6fLzc31+FwlP+V3v3333/u3LktW7boGJgG6nLbASB6\nMAINoIYpLS1t0KDBE088UVZy/vz5f/zjH+UvnFxb1eW2A0D0MMyaNUvvGABABbPZfOrUqUWL\nFp08ebKwsHD79u3jxo1zuVzLly93OBx6RxdZdbntABA9mMIBoOZxu90vvfTSm2++efLkyZSU\nlPbt28+fPz8jI0PvuLRQl9sOAFGCBBoAAABQgTnQAAAAgAok0AAAAIAKJNAAAACACiTQAAAA\ngAok0AAAAIAKJNAAAACACiTQAAAAgAok0AAAAIAKJNAAAACACv8fF0y7bwfEpcMAAAAASUVO\nRK5CYII=",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "ggplot(df_all, aes(x=gene.change, y=protein.change, color=site)) + \n",
    "geom_point() + \n",
    "geom_hline(yintercept = 0, color='grey') + \n",
    "geom_vline(xintercept = 0, color='grey') +\n",
    "xlim(c(-3, 3)) +\n",
    "ylim(c(-3, 3)) +\n",
    "facet_grid(~ gene)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "R",
   "language": "R",
   "name": "r"
  },
  "language_info": {
   "codemirror_mode": "r",
   "file_extension": ".r",
   "mimetype": "text/x-r-source",
   "name": "R",
   "pygments_lexer": "r",
   "version": "3.4.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
